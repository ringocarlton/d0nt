<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>d0nt.blinkk</title>
    <link rel="icon" href="favicon.png" type="image/png">
    <style>
        :root {
            --ease: cubic-bezier(.25,.1,.25,1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #000;
            height: 100vh;
            overflow: hidden;
            color: white;
            touch-action: pan-y;
        }

        /* PSP Main Screen */
        .psp-screen {
            width: 100%;
            height: 100vh;
            position: relative;
            background: radial-gradient(ellipse at center, #16213e 0%, #0a0e27 100%);
            transition: opacity 0.5s ease;
        }

        .waves {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.3;
        }

        .wave {
            position: absolute;
            width: 200%;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: wave 3s linear infinite;
        }

        .wave:nth-child(1) { top: 20%; animation-delay: 0s; }
        .wave:nth-child(2) { top: 40%; animation-delay: 0.5s; }
        .wave:nth-child(3) { top: 60%; animation-delay: 1s; }
        .wave:nth-child(4) { top: 80%; animation-delay: 1.5s; }

        @keyframes wave {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .xmb-container {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .menu-items {
            display: flex;
            gap: 80px;
            align-items: center;
            position: relative;
        }

        .menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
            cursor: pointer;
            opacity: 0.4;
            transform: scale(0.7);
            -webkit-tap-highlight-color: transparent;
        }

        .menu-item.active {
            opacity: 1;
            transform: scale(1.3);
        }

        .menu-icon {
            width: 100px;
            height: 100px;
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .menu-item.active .menu-icon {
            border-color: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.4);
        }

        .menu-icon svg {
            width: 50px;
            height: 50px;
            stroke: rgba(255, 255, 255, 0.7);
            fill: none;
            stroke-width: 2;
            transition: all 0.3s ease;
        }

        .menu-item.active .menu-icon svg {
            stroke: #fff;
        }

        .time-date {
            position: absolute;
            top: 20px;
            right: 30px;
            text-align: right;
            font-size: 14px;
            opacity: 0.8;
        }

        .vertical-line {
            position: absolute;
            width: 2px;
            height: 100%;
            background: linear-gradient(to bottom, transparent, rgba(255,255,255,0.3), transparent);
            left: 50%;
            transform: translateX(-50%);
            opacity: 0.5;
        }

        .horizontal-line {
            position: absolute;
            height: 2px;
            width: 100%;
            background: linear-gradient(to right, transparent, rgba(255,255,255,0.3), transparent);
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.5;
        }

        /* Transition Screen */
        .transition-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #000;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .transition-screen.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .loading-icon {
            width: 80px;
            height: 80px;
            border: 4px solid rgba(255,255,255,0.2);
            border-top: 4px solid #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Desktop View (for Projects) */
        .desktop-view {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: radial-gradient(ellipse at center, #16213e 0%, #0a0e27 100%);
            display: none;
            z-index: 999;
            overflow: hidden;
        }

        .desktop-view.active {
            display: block;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: transparent;
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            z-index: 2000;
            -webkit-tap-highlight-color: transparent;
            transition: all 0.3s ease;
        }

        .back-btn:hover, .back-btn:active {
            border-color: rgba(255,255,255,0.8);
            box-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        /* Desktop Icons */
        .icon {
            position: absolute;
            width: 100px;
            text-align: center;
            user-select: none;
            cursor: grab;
            transition: transform .18s var(--ease), box-shadow .18s var(--ease);
            -webkit-tap-highlight-color: transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .icon img {
            width: 100px;
            height: 100px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 12px rgba(0,0,0,.18);
            will-change: left, top, transform;
            transition: transform .18s var(--ease), box-shadow .18s var(--ease);
            display: block;
        }

        .icon span {
            font-size: 12px;
            color: inherit;
            max-width: 110px;
            word-break: break-word;
        }

        .icon:hover img {
            transform: scale(1.05);
            box-shadow: 0 8px 22px rgba(0,0,0,.22);
        }

        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 3000;
            background: rgba(0,0,0,.85);
            backdrop-filter: blur(8px);
            align-items: center;
            justify-content: center;
        }

        .lightbox.visible {
            display: flex;
        }

        .lightbox-card {
            max-width: 92%;
            max-height: 92%;
            border-radius: 14px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .lightbox-card img {
            max-width: 100%;
            max-height: 80vh;
            border-radius: 10px;
            display: block;
        }

        .lightbox-caption {
            padding: 10px 14px;
            font-size: 13px;
            color: rgba(255,255,255,0.9);
            background: rgba(0,0,0,.12);
            width: 100%;
            text-align: center;
        }

        /* Gallery View (for Skills & CV) */
        .gallery-view {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: radial-gradient(ellipse at center, #16213e 0%, #0a0e27 100%);
            display: none;
            flex-direction: column;
            z-index: 999;
        }

        .gallery-view.active {
            display: flex;
        }

        .gallery-header {
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .gallery-grid {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 30px;
            align-content: start;
        }

        /* Skills Grid */
        .skill-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .skill-icon {
            width: 80px;
            height: 80px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .skill-icon:hover {
            border-color: rgba(255,255,255,0.8);
            box-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        .skill-icon img {
            width: 50px;
            height: 50px;
            object-fit: contain;
            filter: grayscale(100%) brightness(200%);
        }

        .skill-name {
            font-size: 14px;
            opacity: 0.8;
        }

        /* CV Viewer */
        .cv-viewer {
            width: 100%;
            height: calc(100vh - 80px);
            border: none;
            background: white;
        }

        .error-message {
            text-align: center;
            padding: 40px;
            opacity: 0.6;
        }

        @media (max-width: 768px) {
            .menu-items {
                gap: 50px;
            }
            .menu-icon {
                width: 80px;
                height: 80px;
            }
            .menu-icon svg {
                width: 40px;
                height: 40px;
            }
            .icon, .icon img {
                width: 80px;
                height: 80px;
            }
            .icon span {
                font-size: 10px;
            }
            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 20px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- PSP Main Screen -->
    <div class="psp-screen" id="mainScreen">
        <div class="waves">
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
        </div>

        <div class="vertical-line"></div>
        <div class="horizontal-line"></div>

        <div class="time-date">
            <div id="time"></div>
            <div id="date"></div>
        </div>

        <div class="xmb-container">
            <div class="menu-items">
                <div class="menu-item" data-section="about">
                    <div class="menu-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                    </div>
                </div>
                <div class="menu-item active" data-section="projects">
                    <div class="menu-icon">
                        <svg viewBox="0 0 24 24">
                            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                        </svg>
                    </div>
                </div>
                <div class="menu-item" data-section="skills">
                    <div class="menu-icon">
                        <svg viewBox="0 0 24 24">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                        </svg>
                    </div>
                </div>
                <div class="menu-item" data-section="contact">
                    <div class="menu-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                            <polyline points="22,6 12,13 2,6"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Transition Screen -->
    <div class="transition-screen" id="transitionScreen">
        <div class="loading-icon"></div>
    </div>

    <!-- Desktop View (Projects with draggable icons) -->
    <div class="desktop-view" id="desktopView">
        <button class="back-btn" id="desktopBackBtn">← Back</button>
        <div class="time-date">
            <div id="desktopTime"></div>
        </div>
        <div id="desktop"></div>
    </div>

    <!-- Gallery View (Skills & CV) -->
    <div class="gallery-view" id="galleryView">
        <div class="gallery-header">
            <button class="back-btn" id="galleryBackBtn">← Back</button>
            <div class="time-date">
                <div id="galleryTime"></div>
            </div>
        </div>
        <div class="gallery-grid" id="galleryGrid"></div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-card">
            <img id="lightboxImg" src="" alt="preview" />
            <div class="lightbox-caption" id="lightboxCaption"></div>
        </div>
    </div>

    <script>
        const menuItems = document.querySelectorAll('.menu-item');
        const mainScreen = document.getElementById('mainScreen');
        const transitionScreen = document.getElementById('transitionScreen');
        const desktopView = document.getElementById('desktopView');
        const galleryView = document.getElementById('galleryView');
        const desktop = document.getElementById('desktop');
        const galleryGrid = document.getElementById('galleryGrid');
        const desktopBackBtn = document.getElementById('desktopBackBtn');
        const galleryBackBtn = document.getElementById('galleryBackBtn');
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightboxImg');
        const lightboxCaption = document.getElementById('lightboxCaption');
        let currentIndex = 1;
        let topZ = 100;

        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
            const dateStr = now.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
            document.getElementById('time').textContent = timeStr;
            document.getElementById('date').textContent = dateStr;
            document.getElementById('galleryTime').textContent = timeStr;
            document.getElementById('desktopTime').textContent = timeStr;
        }

        updateTime();
        setInterval(updateTime, 1000);

        function setActive(index) {
            menuItems.forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });
        }

        // Projects - Desktop with draggable icons
        async function loadProjects() {
            try {
                const response = await fetch('images.json');
                if (!response.ok) throw new Error('Failed to load projects');
                
                const images = await response.json();
                desktop.innerHTML = '';
                images.forEach(createIcon);
                startDrift();
            } catch (error) {
                console.error('Error loading projects:', error);
                desktop.innerHTML = '<div class="error-message">Unable to load projects. Please ensure images.json exists.</div>';
            }
        }

        function createIcon(filename) {
            const icon = document.createElement('div');
            icon.className = 'icon';
            const left = 40 + Math.random() * (window.innerWidth - 200);
            const top = 80 + Math.random() * (window.innerHeight - 220);
            icon.style.left = `${left}px`;
            icon.style.top = `${top}px`;
            icon.innerHTML = `<img src="images/${filename}" alt="${filename}"><span>${filename.replace(/\.[^/.]+$/, '')}</span>`;
            desktop.appendChild(icon);

            const img = icon.querySelector('img');
            let isDragging = false, startX = 0, startY = 0, offsetX = 0, offsetY = 0, moved = false;
            let lastX = 0, lastY = 0, lastTime = 0, vx = 0, vy = 0;
            const isTouchDevice = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;

            function onPointerDown(e) {
                e.preventDefault();
                img.setPointerCapture(e.pointerId);
                isDragging = true;
                moved = false;
                startX = e.clientX;
                startY = e.clientY;
                offsetX = e.clientX - icon.getBoundingClientRect().left;
                offsetY = e.clientY - icon.getBoundingClientRect().top;
                lastX = e.clientX;
                lastY = e.clientY;
                lastTime = performance.now();
                topZ += 1;
                icon.style.zIndex = topZ;
                icon.style.cursor = 'grabbing';
            }

            function onPointerMove(e) {
                if (!isDragging) return;
                const dx = e.clientX - startX, dy = e.clientY - startY;
                if (Math.abs(dx) > 8 || Math.abs(dy) > 8) moved = true;
                const now = performance.now();
                const dt = Math.max(16, now - lastTime);
                vx = (e.clientX - lastX) / dt;
                vy = (e.clientY - lastY) / dt;
                lastX = e.clientX;
                lastY = e.clientY;
                lastTime = now;
                icon.style.left = (e.clientX - offsetX) + 'px';
                icon.style.top = (e.clientY - offsetY) + 'px';
            }

            function onPointerUp(e) {
                img.releasePointerCapture(e.pointerId);
                icon.style.cursor = 'grab';
                isDragging = false;

                if (isTouchDevice && (Math.abs(vx) > 0.01 || Math.abs(vy) > 0.01)) {
                    let decay = 0.92;
                    function step() {
                        let x = parseFloat(icon.style.left) || 0;
                        let y = parseFloat(icon.style.top) || 0;
                        vx *= decay;
                        vy *= decay;
                        x += vx * 16;
                        y += vy * 16;
                        const maxX = window.innerWidth - icon.offsetWidth - 8;
                        const maxY = window.innerHeight - icon.offsetHeight - 8;
                        x = Math.max(8, Math.min(maxX, x));
                        y = Math.max(8, Math.min(maxY, y));
                        icon.style.left = x + 'px';
                        icon.style.top = y + 'px';
                        if (Math.abs(vx) > 0.05 || Math.abs(vy) > 0.05) requestAnimationFrame(step);
                    }
                    requestAnimationFrame(step);
                }
            }

            icon.addEventListener('pointerdown', onPointerDown);
            icon.addEventListener('pointermove', onPointerMove);
            icon.addEventListener('pointerup', onPointerUp);
            icon.addEventListener('pointercancel', () => {
                isDragging = false;
                icon.style.cursor = 'grab';
            });

            icon.addEventListener('click', () => {
                if (!moved) showLightbox(`images/${filename}`, filename);
            });
        }

        function showLightbox(src, filename) {
            lightboxImg.src = src;
            lightboxCaption.textContent = filename.replace(/\.[^/.]+$/, '');
            lightbox.classList.add('visible');
        }

        lightbox.addEventListener('click', () => {
            lightbox.classList.remove('visible');
        });

        function startDrift() {
            const icons = document.querySelectorAll('.icon');
            function drift(t) {
                icons.forEach((icon, i) => {
                    const amp = 6;
                    const speed = 0.0003 + (i % 7) * 0.00005;
                    const dx = Math.sin((t * speed) + (i)) * amp;
                    const dy = Math.cos((t * speed * 1.1) + (i)) * amp * 0.6;
                    icon.style.transform = `translate(${dx}px,${dy}px)`;
                });
                requestAnimationFrame(drift);
            }
            requestAnimationFrame(drift);
        }

        // Skills
        async function loadSkills() {
            try {
                const response = await fetch('skills.json');
                if (!response.ok) throw new Error('Failed to load skills');
                
                const data = await response.json();
                displaySkills(data.skills);
            } catch (error) {
                console.error('Error loading skills:', error);
                galleryGrid.innerHTML = '<div class="error-message">Unable to load skills. Please ensure skills.json exists.</div>';
            }
        }

        function displaySkills(skills) {
            galleryGrid.innerHTML = '';
            
            if (!skills || skills.length === 0) {
                galleryGrid.innerHTML = '<div class="error-message">No skills found.</div>';
                return;
            }

            skills.forEach(skill => {
                const item = document.createElement('div');
                item.className = 'skill-item';
                item.innerHTML = `
                    <div class="skill-icon">
                        <img src="${skill.icon}" alt="${skill.name}">
                    </div>
                    <div class="skill-name">${skill.name}</div>
                `;
                galleryGrid.appendChild(item);
            });
        }

        // CV
        function loadCV() {
            galleryGrid.innerHTML = '';
            galleryGrid.style.gridTemplateColumns = '1fr';
            
            const iframe = document.createElement('iframe');
            iframe.className = 'cv-viewer';
            iframe.src = 'cv.pdf';
            
            galleryGrid.appendChild(iframe);
        }

        // Email
        function openEmail() {
            window.location.href = 'mailto:your.email@example.com?subject=Portfolio Inquiry';
        }

        // Show views with transition
        function showDesktop() {
            transitionScreen.classList.add('active');
            
            setTimeout(() => {
                mainScreen.style.display = 'none';
                transitionScreen.classList.remove('active');
                desktopView.classList.add('active');
                loadProjects();
            }, 800);
        }

        function showGallery(type) {
            transitionScreen.classList.add('active');
            
            setTimeout(() => {
                mainScreen.style.display = 'none';
                transitionScreen.classList.remove('active');
                galleryView.classList.add('active');
                
                if (type === 'skills') {
                    loadSkills();
                } else if (type === 'about') {
                    loadCV();
                }
            }, 800);
        }

        function hideAllViews() {
            desktopView.classList.remove('active');
            galleryView.classList.remove('active');
            mainScreen.style.display = 'block';
        }

        // Menu navigation
        menuItems.forEach((item, index) => {
            item.addEventListener('click', () => {
                currentIndex = index;
                setActive(currentIndex);
                
                const section = item.dataset.section;
                if (section === 'contact') {
                    openEmail();
                } else if (section === 'projects') {
                    showDesktop();
                } else {
                    showGallery(section);
                }
            });
        });

        desktopBackBtn.addEventListener('click', hideAllViews);
        galleryBackBtn.addEventListener('click', hideAllViews);

        // Touch swipe support
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            if (desktopView.classList.contains('active') || galleryView.classList.contains('active')) return;
            
            if (touchEndX < touchStartX - 50 && currentIndex < menuItems.length - 1) {
                currentIndex++;
                setActive(currentIndex);
            }
            
            if (touchEndX > touchStartX + 50 && currentIndex > 0) {
                currentIndex--;
                setActive(currentIndex);
            }
        }

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (lightbox.classList.contains('visible')) {
                if (e.key === 'Escape') lightbox.classList.remove('visible');
                return;
            }

            if (desktopView.classList.contains('active') || galleryView.classList.contains('active')) {
                if (e.key === 'Escape') hideAllViews();
                return;
            }

            if (e.key === 'ArrowLeft' && currentIndex > 0) {
                currentIndex--;
                setActive(currentIndex);
            } else if (e.key === 'ArrowRight' && currentIndex < menuItems.length - 1) {
                currentIndex++;
                setActive(currentIndex);
            } else if (e.key === 'Enter') {
                const section = menuItems[currentIndex].dataset.section;
                if (section === 'contact') {
                    openEmail();
                } else if (section === 'projects') {
                    showDesktop();
                } else {
                    showGallery(section);
                }
            }
        });

        // Window resize handler
        window.addEventListener('resize', () => {
            document.querySelectorAll('.icon').forEach(icon => {
                const x = parseFloat(icon.style.left) || 0;
                const y = parseFloat(icon.style.top) || 0;
                const maxX = window.innerWidth - icon.offsetWidth - 8;
                const maxY = window.innerHeight - icon.offsetHeight - 8;
                if (x > maxX) icon.style.left = maxX + 'px';
                if (y > maxY) icon.style.top = maxY + 'px';
            });
        });
    </script>
</body>
</html>
