<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>test — d0nt.blinkk (Tate)</title>
  <meta name="description" content="Test build of d0nt.blinkk portfolio (Tate). Replace projects.json and images/ with your real content." />
  <style>
    :root{--bg-dark:linear-gradient(180deg,#0f1220 0%,#1b2030 100%);--accent:rgba(255,255,255,0.92);--ease:cubic-bezier(.25,.1,.25,1);}
    html,body{height:100%;margin:0;font-family:"IBM Plex Mono",monospace;background:var(--bg-dark);color:#f3f4f8;overflow:hidden;touch-action:none}
    .desktop{position:relative;width:100vw;height:100vh;overflow:hidden}
    .icon{position:absolute;width:100px;text-align:center;user-select:none;cursor:grab;display:flex;flex-direction:column;align-items:center;gap:6px;transition:opacity .3s ease,transform .18s var(--ease);opacity:0}
    .icon.visible{opacity:1}
    .icon img{width:100px;height:100px;border-radius:12px;object-fit:cover;box-shadow:0 4px 12px rgba(0,0,0,.3)}
    .icon span{font-size:12px;max-width:110px;word-break:break-word}
    .lightbox{display:none;position:fixed;inset:0;align-items:center;justify-content:center;background:rgba(0,0,0,.86);backdrop-filter:blur(6px);z-index:4000;opacity:0;transition:opacity .25s ease}
    .lightbox.visible{display:flex;opacity:1}
    .lightbox-card{max-width:92%;max-height:92%;border-radius:12px;overflow:hidden;background:#0b0b0b}
    .lightbox-card img{max-width:100%;max-height:76vh;display:block}
    .meta{padding:10px 12px;color:var(--accent);display:flex;justify-content:space-between;align-items:center;gap:10px;background:rgba(255,255,255,.02)}
    .btn{background:transparent;border:1px solid rgba(255,255,255,.08);padding:8px 10px;border-radius:8px;color:var(--accent);cursor:pointer}
    #intro{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:4500}
    .about-btn{position:fixed;top:12px;left:16px;z-index:4600;background:rgba(255,255,255,.06);border-radius:8px;padding:6px 9px;border:0;cursor:pointer}
    .controls{position:fixed;top:12px;right:16px;z-index:4600}
    .contact{position:fixed;left:16px;bottom:12px;z-index:4600}
    .resume-section{position:fixed;right:16px;bottom:12px;z-index:4600}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}
  </style>
</head>
<body>
  <div id="intro" role="dialog" aria-modal="true">
    <div style="text-align:center;color:#fff">
      <h1 style="margin:0 0 10px">test — d0nt.blinkk</h1>
      <p style="margin:0 0 12px">Drag icons. Click to open project. This is a test package.</p>
      <button id="enter">enter</button>
    </div>
  </div>

  <button class="about-btn" id="aboutBtn" aria-expanded="false">?</button>
  <div class="controls">
    <button id="themeToggle">Night</button>
  </div>

  <div class="contact"><a id="insta" href="https://instagram.com/d0nt.blinkk" target="_blank" rel="noopener" style="color:#fff;text-decoration:none">Instagram</a> · <a id="lnk" href="https://www.linkedin.com/in/tatenda-choruma-1201761ab" target="_blank" rel="noopener" style="color:#fff;text-decoration:none">LinkedIn</a></div>

  <div class="resume-section">
    <a id="resumeLink" class="btn" href="resume.pdf" download>Download resume (test)</a>
  </div>

  <div class="desktop" id="desktop" role="region" aria-label="Portfolio canvas"></div>

  <div class="lightbox" id="lightbox" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="lightbox-card" role="document">
      <img id="lbImg" src="" alt="">
      <div class="meta">
        <div>
          <div id="lbTitle" style="font-weight:700"></div>
          <div id="lbDesc" style="font-size:13px;opacity:.9"></div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <a id="lbLink" class="btn" href="#" target="_blank" rel="noopener" style="display:none">View project</a>
          <button id="lbClose" class="btn">Close</button>
        </div>
      </div>
    </div>
  </div>

<script>
(async function(){
  const desktop = document.getElementById('desktop');
  const lightbox = document.getElementById('lightbox');
  const lbImg = document.getElementById('lbImg');
  const lbTitle = document.getElementById('lbTitle');
  const lbDesc = document.getElementById('lbDesc');
  const lbLink = document.getElementById('lbLink');
  const lbClose = document.getElementById('lbClose');

  // attempt to load structured projects.json first, fallback to images.json
  let projects = [];
  try {
    const res = await fetch('projects.json');
    if(res.ok){
      const data = await res.json();
      if(Array.isArray(data) && data[0] && data[0].file) {
        projects = data;
      }
    }
  } catch(e){ /* ignore */ }

  if(projects.length === 0){
    try {
      const res2 = await fetch('images.json');
      if(res2.ok){
        const arr = await res2.json();
        if(Array.isArray(arr)){
          projects = arr.map(f => ({ file: f, title: '', desc: '', link: '' }));
        }
      }
    } catch(e){ /* ignore */ }
  }

  // create icons
  projects.forEach((p, i) => createIcon(p, i));
  // store for navigation
  window.__PROJECTS = projects;

  // reveal icons
  setTimeout(()=>document.querySelectorAll('.icon').forEach((el,i)=>setTimeout(()=>el.classList.add('visible'), i*50)), 120);

  function createIcon(item, idx){
    const icon = document.createElement('div');
    icon.className = 'icon';
    const left = 40 + Math.random() * (window.innerWidth - 200);
    const top = 60 + Math.random() * (window.innerHeight - 220);
    icon.style.left = left + 'px';
    icon.style.top = top + 'px';
    icon.innerHTML = `<img src="images/${item.file}" alt="${(item.title||item.file)}" loading="lazy"><span>${item.title||item.file.replace(/\.[^/.]+$/,'')}</span>`;
    desktop.appendChild(icon);

    // simple drag
    let dragging=false, startX=0, startY=0, offsetX=0, offsetY=0, moved=false;
    icon.addEventListener('pointerdown', e=>{
      if(e.pointerType==='mouse' && e.button !== 0) return;
      e.preventDefault();
      dragging=true; moved=false;
      startX=e.clientX; startY=e.clientY;
      offsetX=e.clientX - icon.getBoundingClientRect().left;
      offsetY=e.clientY - icon.getBoundingClientRect().top;
      icon.style.cursor='grabbing';
    });
    icon.addEventListener('pointermove', e=>{
      if(!dragging) return;
      const dx = e.clientX - startX, dy = e.clientY - startY;
      if(Math.abs(dx)>6 || Math.abs(dy)>6) moved=true;
      icon.style.left = (e.clientX - offsetX) + 'px';
      icon.style.top = (e.clientY - offsetY) + 'px';
    });
    icon.addEventListener('pointerup', e=>{
      dragging=false; icon.style.cursor='grab';
    });
    icon.addEventListener('click', ()=>{
      if(!moved) openLightbox(item);
    });
  }

  function openLightbox(item){
    lbImg.src = 'images/' + item.file;
    lbImg.alt = item.title || item.file;
    lbTitle.textContent = item.title || '';
    lbDesc.textContent = item.desc || '';
    if(item.link && item.link.trim() !== ''){
      lbLink.style.display = 'inline-block';
      lbLink.href = item.link;
    } else {
      lbLink.style.display = 'none';
      lbLink.href = '#';
    }
    lightbox.classList.add('visible');
    lightbox.setAttribute('aria-hidden','false');
    lbClose.focus();
  }

  function closeLightbox(){
    lightbox.classList.remove('visible');
    lightbox.setAttribute('aria-hidden','true');
    lbImg.src = '';
  }

  lbClose.addEventListener('click', closeLightbox);
  lightbox.addEventListener('click', (e)=>{ if(e.target === lightbox) closeLightbox(); });
  window.addEventListener('keydown', e=>{ if(e.key==='Escape') closeLightbox(); if(e.key==='ArrowLeft') nav(-1); if(e.key==='ArrowRight') nav(1); });

  function nav(dir){
    const list = window.__PROJECTS || [];
    if(!list.length) return;
    const current = list.findIndex(p => p.file === (lbImg.src.split('/').pop()));
    if(current === -1) return;
    const next = (current + dir + list.length) % list.length;
    openLightbox(list[next]);
  }

})();
</script>
</body>
</html>
