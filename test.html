<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>d0nt.blinkk</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <style>
    :root{
      --bg-light: linear-gradient(180deg,#d9e0e7 0%,#cdd5df 100%);
      --bg-dark: linear-gradient(180deg,#0f1220 0%,#1b2030 100%);
      --accent: rgba(255,255,255,0.9);
      --ease: cubic-bezier(.25,.1,.25,1);
    }
    html,body{height:100%;margin:0;font-family:"IBM Plex Mono",monospace;overflow:hidden;touch-action:none}
    body.light{background:var(--bg-light);color:#000}
    body.dark{background:var(--bg-dark);color:#f3f4f8}

    .desktop{position:relative;width:100vw;height:100vh;overflow:hidden;transition:background .45s var(--ease)}

    .icon{
      position:absolute;
      width:100px;
      text-align:center;
      user-select:none;
      cursor:grab;
      transition:transform .18s var(--ease),box-shadow .18s var(--ease);
      -webkit-tap-highlight-color: transparent;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:6px;
    }
    .icon img{
      width:100px;height:100px;border-radius:12px;object-fit:cover;
      box-shadow:0 4px 12px rgba(0,0,0,.18);
      will-change:left,top,transform;
      transition:transform .18s var(--ease),box-shadow .18s var(--ease);
      display:block;
    }
    .icon span{font-size:12px;color:inherit;max-width:110px;word-break:break-word}
    .icon:hover img{transform:scale(1.05);box-shadow:0 8px 22px rgba(0,0,0,.22)}

    @media (max-width:768px){
      .icon,.icon img{width:80px;height:80px}
      .icon span{font-size:10px}
    }

    .lightbox{display:none;position:fixed;inset:0;z-index:3000;background:rgba(0,0,0,.85);backdrop-filter:blur(8px);align-items:center;justify-content:center;padding:16px;}
    .lightbox.visible{display:flex}
    
    /* Updated Lightbox Card styles for scrolling content */
    .lightbox-card{
      max-width: 800px;
      width: 100%;
      max-height: 90vh;
      border-radius: 14px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      background: #fff;
      box-shadow: 0 20px 60px rgba(0,0,0,.4);
    }
    
    /* New scrollable content area */
    .lightbox-content {
      padding: 24px 32px;
      overflow-y: auto;
      flex-grow: 1;
      color: #111;
    }

    /* New styles for content *inside* the scrollable area */
    .lightbox-content img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      margin-bottom: 16px;
    }
    
    .lightbox-content h2 {
      margin-top: 0;
      margin-bottom: 12px;
      color: #000;
      font-family: "IBM Plex Mono", monospace;
    }

    .lightbox-content p {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; /* More readable font */
      font-size: 1rem;
      line-height: 1.6;
      margin-bottom: 24px;
      color: #333;
    }

    /* New container for additional images */
    .lightbox-content h3 {
      font-family: "IBM Plex Mono", monospace;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
      margin-bottom: 16px;
    }
    .lightbox-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }
    .lightbox-gallery img {
      margin-bottom: 0;
      border: 1px solid #eee;
    }

    /* New Close Button */
    .lightbox-close {
        position: absolute;
        top: 12px;
        right: 12px;
        z-index: 3010; /* Above card */
        background: rgba(0,0,0,.3);
        color: #fff;
        border: 0;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        font-size: 22px;
        cursor: pointer;
        line-height: 36px;
        text-align: center;
        transition: background .2s var(--ease);
    }
    .lightbox-close:hover {
      background: rgba(0,0,0,.6);
    }

    /* Dark mode for new lightbox */
    body.dark .lightbox-card {
      background: #1b2030;
    }
    body.dark .lightbox-content {
      color: #f3f4f8;
    }
    body.dark .lightbox-content h2 {
      color: #fff;
    }
    body.dark .lightbox-content p {
      color: #ccc;
    }
    body.dark .lightbox-content h3 {
      border-color: #333;
    }
    body.dark .lightbox-gallery img {
      border-color: #333;
    }

    /* Remove old/conflicting styles */
    .lightbox-caption{display: none;}

    #intro-overlay{position:fixed;inset:0;z-index:4000;background:rgba(0,0,0,.82);display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;transition:opacity .6s var(--ease)}
    #intro-overlay.hidden{opacity:0;pointer-events:none;display:block}
    #intro-overlay h1{margin:0;font-size:1.6rem;letter-spacing:1px}
    #intro-overlay p{margin:10px 0 18px;opacity:.92}
    #enter-btn{border:1px solid #fff;padding:8px 14px;background:transparent;color:#fff;cursor:pointer;border-radius:8px;font-family:inherit}
    #enter-btn:hover{background:#fff;color:#000}

    .contact-info{position:fixed;left:16px;bottom:12px;font-size:12px;color:rgba(0,0,0,.6);z-index:2000}
    body.dark .contact-info{color:rgba(255,255,255,.65)}
    .contact-info a{color:inherit;text-decoration:none;font-weight:600}

    .controls{position:fixed;top:12px;right:16px;display:flex;gap:8px;z-index:2000}
    .controls button{background:rgba(255,255,255,.85);border:0;padding:6px 10px;border-radius:8px;cursor:pointer;font-family:inherit;transition:background .2s var(--ease)}
    body.dark .controls button{background:rgba(20,20,30,.9);color:#fff}
    .controls button:hover{transform:translateY(-2px)}

    .about-btn{position:fixed;top:12px;left:16px;z-index:2000;background:rgba(255,255,255,.8);border-radius:8px;padding:6px 9px;border:0;cursor:pointer}
    body.dark .about-btn{background:rgba(20,20,30,.9);color:#fff}

    .about-overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:3500}
    .about-overlay.visible{display:flex}
    .about-card{max-width:680px;background:var(--accent);color:#000;padding:22px;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,.4)}
    body.dark .about-card{background:linear-gradient(180deg,#14161b,#20232b);color:#fff}

    .idle .contact-info{opacity:.7}
  </style>
</head>
<body class="light">
  <div id="intro-overlay" role="dialog" aria-modal="true">
    <h1>d0nt.blinkk</h1>
    <p>Drag the icons, explore the works.</p>
    <button id="enter-btn">Enter</button>
  </div>

  <button class="about-btn" id="aboutBtn">?</button>
  <div class="about-overlay" id="aboutOverlay" aria-hidden="true">
    <div class="about-card">
      <h3>About</h3>
      <p style="margin-top:8px">
        d0nt.blinkk is the creative universe of Tate, a multifaceted artist exploring ideas through motion, identity, and digital form. With a background in Fine Art, Tate’s work moves fluidly between mediums, translating emotion into imagery and rhythm into atmosphere.
      </p>
      <p style="margin-top:12px;font-size:13px;color:rgba(0,0,0,.7)">Contact: <a href="https://instagram.com/d0nt.blinkk" target="_blank" rel="noopener">instagram.com/d0nt.blinkk</a></p>
      <div style="text-align:right;margin-top:12px">
        <button id="closeAbout" style="padding:6px 10px;border:0;background:#111;color:#fff;border-radius:8px;cursor:pointer">close</button>
      </div>
    </div>
  </div>

  <div class="controls" role="toolbar">
    <button id="themeToggle">Night</button>
  </div>

  <div class="contact-info">© 2025 <a href="https://instagram.com/d0nt.blinkk" target="_blank" rel="noopener">d0nt.blinkk</a></div>

  <div class="desktop" id="desktop"></div>

  <div class="lightbox" id="lightbox" aria-hidden="true">
    <button class="lightbox-close" id="lightboxClose" aria-label="Close">&times;</button>
    <div class="lightbox-card">
      <!-- New scrollable content area -->
      <div class="lightbox-content" id="lightboxContent">
          <!-- Content injected by JS -->
      </div>
    </div>
  </div>

  <script>
    let topZ = 100;
    const desktop = document.getElementById('desktop');
    const lightbox = document.getElementById('lightbox');
    // REMOVED:
    // const lightboxImg = document.getElementById('lightboxImg');
    // const lightboxCaption = document.getElementById('lightboxCaption');
    // NEW:
    const lightboxContent = document.getElementById('lightboxContent');
    const lightboxClose = document.getElementById('lightboxClose');

    const themeToggle = document.getElementById('themeToggle');
    const introOverlay = document.getElementById('intro-overlay');
    const enterBtn = document.getElementById('enter-btn');
    const aboutBtn = document.getElementById('aboutBtn');
    const aboutOverlay = document.getElementById('aboutOverlay');
    const closeAbout = document.getElementById('closeAbout');

    // Helper function for placeholders
    const getPlaceholder = (text, size = '100x100', bg = '333', fg = 'FFF') => {
      const cleanText = text.replace(/\.[^/.]+$/, ''); // Remove file extension
      return `https://placehold.co/${size}/${bg}/${fg}?text=${encodeURIComponent(cleanText)}`;
    };

    // MODIFICATION: Embed the image data directly to avoid fetch error
    // Updated to be an array of objects
    const images = [
      {
        "icon": "ocean-drive.jpg",
        "title": "Ocean Drive",
        "description": "A study of color and light on the iconic Ocean Drive. This piece explores the contrast between the neon glow and the twilight sky, capturing the vibrant energy of the night.",
        "additionalImages": ["ocean-drive-detail.jpg", "ocean-drive-sketch.png", "ocean-drive-mood.jpg"]
      },
      {
        "icon": "portrait-study.png",
        "title": "Portrait Study",
        "description": "An exploration of form and shadow in classical portraiture. The focus was on creating a sense of depth and emotion through subtle variations in tone.",
        "additionalImages": ["portrait-angle.png", "portrait-wip.jpg"]
      },
      {
        "icon": "abstract-motion.gif",
        "title": "Abstract Motion",
        "description": "This animated piece translates the rhythm of electronic music into a visual, generative form. Each frame is a response to a specific frequency, creating a living, breathing artwork.",
        "additionalImages": ["motion-still-1.jpg", "motion-still-2.jpg"]
      },
      {
        "icon": "city-lights.jpeg",
        "title": "City Lights",
        "description": "Long-exposure photograph of the downtown area, aiming to capture the constant flow of energy that defines the urban landscape.",
        "additionalImages": ["city-lights-b&w.jpg"]
      },
      {
        "icon": "forest-path.jpg",
        "title": "Forest Path",
        "description": "A quiet moment captured during an early morning hike. The lighting and atmosphere were perfect, creating a sense of peace and solitude.",
        "additionalImages": ["forest-macro.jpg", "forest-stream.jpg"]
      },
      {
        "icon": "glass-sculpture.png",
        "title": "Glass Sculpture",
        "description": "3D render of a fictional glass sculpture, focusing on realistic refraction and caustics. This was a technical exercise in material properties.",
        "additionalImages": ["glass-render-2.png", "glass-clay.png"]
      }
    ];
    
    // Process the images immediately
    try {
      images.forEach(createIcon); 
      startDrift();
    } catch(err) {
      console.error('Error processing images', err);
    }

    function createIcon(item){ // Parameter is now the full object
      const icon = document.createElement('div');
      icon.className = 'icon';
      const left = 40 + Math.random() * (window.innerWidth - 200);
      const top = 60 + Math.random() * (window.innerHeight - 220);
      icon.style.left = `${left}px`;
      icon.style.top = `${top}px`;
      
      // MODIFICATION: Use item properties
      const placeholderText = item.title;
      const placeholderSrc = getPlaceholder(item.icon, '100x100'); // Use icon for placeholder
      icon.innerHTML = `<img src="${placeholderSrc}" alt="${item.title}"><span>${placeholderText}</span>`;
      
      desktop.appendChild(icon);

      const img = icon.querySelector('img');
      let isDragging=false, startX=0, startY=0, offsetX=0, offsetY=0, moved=false, lastX=0, lastY=0, lastTime=0, vx=0, vy=0;
      const isTouchDevice = ('ontouchstart' in window) || navigator.maxTouchPoints>0;

      function onPointerDown(e){
        e.preventDefault();
        // Use pointer capture on the icon itself, or the img if you prefer
        icon.setPointerCapture(e.pointerId);
        isDragging=true; moved=false;
        startX=e.clientX; startY=e.clientY;
        offsetX=e.clientX - icon.getBoundingClientRect().left;
        offsetY=e.clientY - icon.getBoundingClientRect().top;
        lastX = e.clientX; lastY = e.clientY; lastTime = performance.now();
        topZ+=1; icon.style.zIndex = topZ;
        icon.style.cursor='grabbing';
      }

      function onPointerMove(e){
        if(!isDragging) return;
        const dx = e.clientX - startX, dy = e.clientY - startY;
        if(Math.abs(dx)>8 || Math.abs(dy)>8) moved=true;
        const now = performance.now();
        const dt = Math.max(16, now - lastTime);
        vx = (e.clientX - lastX)/dt;
        vy = (e.clientY - lastY)/dt;
        lastX = e.clientX; lastY = e.clientY; lastTime = now;
        icon.style.left = (e.clientX - offsetX) + 'px';
        icon.style.top = (e.clientY - offsetY) + 'px';
      }

      function onPointerUp(e){
        icon.releasePointerCapture(e.pointerId);
        icon.style.cursor='grab';
        isDragging=false;

        if(isTouchDevice && (Math.abs(vx)>0.01 || Math.abs(vy)>0.01)){
          let decay=0.92;
          function step(){
            let x=parseFloat(icon.style.left)||0;
            let y=parseFloat(icon.style.top)||0;
            vx*=decay; vy*=decay;
            x+=vx*16; y+=vy*16;
            const maxX=window.innerWidth - icon.offsetWidth - 8;
            const maxY=window.innerHeight - icon.offsetHeight - 8;
            x=Math.max(8,Math.min(maxX,x));
            y=Math.max(8,Math.min(maxY,y));
            icon.style.left=x+'px';
            icon.style.top=y+'px';
            if(Math.abs(vx)>0.05 || Math.abs(vy)>0.05) requestAnimationFrame(step);
          }
          requestAnimationFrame(step);
        }
      }

      icon.addEventListener('pointerdown', onPointerDown);
      icon.addEventListener('pointermove', onPointerMove);
      icon.addEventListener('pointerup', onPointerUp);
      icon.addEventListener('pointercancel', ()=>{ isDragging=false; icon.style.cursor='grab'; });

      // ✅ Fixed: Lightbox now works on desktop & mobile
      icon.addEventListener('click', ()=>{ if(!moved) showLightbox(item); }); // Pass the whole item
    }

    // REWRITTEN: showLightbox function to build complex HTML
    function showLightbox(item){
      let html = '';
      
      // Main Image (using a larger placeholder)
      html += `<img src="${getPlaceholder(item.title, '800x400', '555')}" alt="${item.title}">`;
      
      // Title
      html += `<h2>${item.title}</h2>`;
      
      // Description
      html += `<p>${item.description}</p>`;
      
      // Additional Images
      if (item.additionalImages && item.additionalImages.length > 0) {
        html += `<h3>Gallery</h3><div class="lightbox-gallery">`;
        item.additionalImages.forEach(imgName => {
          html += `<img src="${getPlaceholder(imgName, '400x300', '777')}" alt="${imgName.replace(/\.[^/.]+$/, '')}">`;
        });
        html += `</div>`;
      }

      lightboxContent.innerHTML = html;
      lightbox.classList.add('visible');
      lightbox.setAttribute('aria-hidden','false');
      lightboxContent.scrollTop = 0; // Ensure it scrolls to top
    }

    // NEW: Function to hide lightbox
    function hideLightbox(){ 
      lightbox.classList.remove('visible'); 
      lightbox.setAttribute('aria-hidden','true'); 
      lightboxContent.innerHTML = ''; // Clear content on close
    }

    // MODIFIED: Close on backdrop click
    lightbox.addEventListener('click', (e)=>{ 
      if (e.target === lightbox) { // Only close if clicking the backdrop
        hideLightbox();
      }
    });

    // NEW: Close on button click
    lightboxClose.addEventListener('click', hideLightbox);

    themeToggle.addEventListener('click', ()=>{
      if(document.body.classList.contains('light')){
        document.body.classList.remove('light'); 
        document.body.classList.add('dark');
        themeToggle.textContent='Day';
      } else {
        document.body.classList.remove('dark'); 
        document.body.classList.add('light');
        themeToggle.textContent='Night';
      }
    });

    enterBtn.addEventListener('click', ()=>{
      introOverlay.classList.add('hidden');
      setTimeout(()=>{ introOverlay.style.display='none'; },700);
    });

    aboutBtn.addEventListener('click', ()=>{ 
      aboutOverlay.classList.add('visible'); 
      aboutOverlay.setAttribute('aria-hidden','false'); 
    });
    closeAbout.addEventListener('click', ()=>{ 
      aboutOverlay.classList.remove('visible'); 
      aboutOverlay.setAttribute('aria-hidden','true'); 
    });
    aboutOverlay.addEventListener('click', (e)=>{ 
      if(e.target===aboutOverlay){ 
        aboutOverlay.classList.remove('visible'); 
        aboutOverlay.setAttribute('aria-hidden','true'); 
      } 
    });

    function startDrift(){
      const icons = document.querySelectorAll('.icon');
      function drift(t){
        icons.forEach((icon,i)=>{
          if (icon.style.cursor === 'grabbing') return; // Don't drift while dragging
          const amp=6;
          const speed=0.0003 + (i%7)*0.00005;
          const dx=Math.sin((t*speed)+(i))*amp;
          const dy=Math.cos((t*speed*1.1)+(i))*amp*0.6;
          icon.style.transform=`translate(${dx}px,${dy}px)`;
        });
        requestAnimationFrame(drift);
      }
      requestAnimationFrame(drift);
    }

    window.addEventListener('resize', ()=>{
      document.querySelectorAll('.icon').forEach(icon=>{
        const x=parseFloat(icon.style.left)||0;
        const y=parseFloat(icon.style.top)||0;
        const maxX=window.innerWidth - icon.offsetWidth - 8;
        const maxY=window.innerHeight - icon.offsetHeight - 8;
        if(x>maxX) icon.style.left=maxX+'px';
        if(y>maxY) icon.style.top=maxY+'px';
      });
    });

    window.addEventListener('keydown', (e)=>{
      if(e.key==='Escape'){ 
        hideLightbox(); // Use new function
        aboutOverlay.classList.remove('visible'); 
        introOverlay.classList.add('hidden'); 
      }
    });
  </script>
</body>
</html>
